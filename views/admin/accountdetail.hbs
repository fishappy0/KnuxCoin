<body>
    <div id="snippetContent">
        <form enctype="multipart/form-data" action="" method="POST">
            <div class="container">
                <div class="row gutters">
                    <div class="col">
                        <div class="card h-100">
                            <div class="card-body">
                                <div class="row gutters">
                                    <div class="col">
                                        <button type="button" class="btn btn-dark" onclick="goBack()" name="goback">Go
                                            Back</button>
                                        <div class="form-group">
                                            <label for="userId">User ID<span style="color: red;">*</span></label>
                                            <input type="text" class="form-control" name="userId" value="{{detail._id}}"
                                                readonly="">
                                        </div>
                                        <div class="form-group">
                                            <label for="fullName">Full Name</label>
                                            <input type="text" class="form-control" value="{{detail.full_name}}"
                                                name="fullName" readonly="">
                                        </div>

                                        <div class="form-group">
                                            <label for="address">Address</label>
                                            <input type="text" class="form-control" value="{{detail.address}}"
                                                name="address" readonly="">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="phone">Phone Number</label>
                                            <input type="number" class="form-control" value="{{detail.phone}}"
                                                name="phone" readonly="">
                                        </div>
                                        <div class="form-group">
                                            <label for="email">Email</label>
                                            <input type="email" class="form-control" value="{{detail.email}}"
                                                name="email" readonly="">
                                        </div>
                                        <div class="form-group">
                                            <label>Date of Birth</label>
                                            <input type="text" class="form-control" value="{{dateFormat detail.dob}}"
                                                name="dob" readonly="">
                                        </div>
                                        <div class="form-group">
                                            <label>Created Date</label>
                                            <input type="text" class="form-control"
                                                value="{{dateHour detail.createdAt}}" name="createdDate" readonly="">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        {{#eq detail.status "locked"}}
                                        <div class="form-group">
                                            <label>Locked Date</label>
                                            <input type="text" class="form-control" value="{{dateHour detail.lockedAt}}"
                                                name="lockedDate" readonly="">
                                        </div>
                                        {{/eq}}
                                        <div class="form-group">
                                            <label for="frontId">Front ID Card</label>
                                            <img src="/images/icon/default-person.png" alt="Front ID Card" width="300"
                                                height="150">
                                        </div>
                                    </div>
                                    <div class="col-md-6">

                                        <div class="form-group">
                                            <label for="backId">Back ID Card</label>
                                            <img src="/images/icon/default-person.png" alt="Front ID Card" width="300"
                                                height="150">

                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Account Status:
                                        {{#eq detail.status "approved"}}
                                        <td><button class="btn btn-success">Approved</button></td>
                                        {{/eq }}

                                        {{#eq detail.status "locked"}}
                                        <td><button type="button" class="btn btn-danger">Locked</button></td>
                                        {{/eq }}

                                        {{#eq detail.status "disabled"}}
                                        <td><button type="button" class="btn btn-danger">Disabled</button></td>
                                        {{/eq }}

                                        {{#eq detail.status "unapproved"}}
                                        <td><button name="unapproved" type="button"
                                                class="btn btn-warning">Unapproved</button></td>
                                        {{/eq }}

                                        {{#eq detail.status "waiting"}}
                                        <td><button name="waiting" type="button" class="btn btn-warning">Wait for
                                                update</button></td>
                                        {{/eq }}
                                    </label>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="container text-center">
                                    <td>
                                        {{#eq detail.status "unapproved"}}
                                        <a><button data-id="{{detail._id}}" type="button"
                                                class="btn btn-success btn-approve" name="aprrove">Approve</button></a>

                                        <a><button data-id="{{detail._id}}" type="button"
                                                class="btn btn-primary btn-send"
                                                name="complementary">Complementary</button></a>

                                        <a><button data-id="{{detail._id}}" type="button"
                                                class="btn btn-danger btn-decline" name="decline">Decline</button></a>
                                        {{/eq }}
                                        {{#eq detail.status "waiting"}}
                                        <a><button data-id="{{detail._id}}" type="button"
                                                class="btn btn-success btn-approve" name="aprrove">Approve</button></a>

                                        <a><button data-id="{{detail._id}}" type="button"
                                                class="btn btn-primary btn-send"
                                                name="complementary">Complementary</button></a>

                                        <a><button data-id="{{detail._id}}" type="button"
                                                class="btn btn-danger btn-decline" name="decline">Decline</button></a>
                                        {{/eq }}
                                        {{#eq detail.status "locked"}}
                                        <a><button data-id="{{detail._id}}" data-name="{{detail.full_name}}"
                                                data-lock="{{detail.lockedAt}}" type="button"
                                                class="btn btn-info btn-unlock" name="unlock">Unlock</button></a>
                                        {{/eq }}

                                    </td>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
        </form>
    </div>
    <!-- Active Modal -->
    <div class="modal fade" id="approve-confirm" tabindex="-1" role="dialog" aria-labelledby="approveLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Active Account</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Do you want to active this account?
                </div>
                <div class="modal-footer">
                    <button data-id="id" id="approved" type="button" class="btn btn-success">Confirm</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Decline Modal -->
    <div class="modal fade" id="decline-confirm" tabindex="-1" role="dialog" aria-labelledby="decline"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Decline Account</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Do you want to decline this account?
                </div>
                <div class="modal-footer">
                    <button data-id="id" id="declined" type="button" class="btn btn-danger">Confirm</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Complementary Modal -->
    <div class="modal fade" id="send-confirm" tabindex="-1" role="dialog" aria-labelledby="sendLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Request Additional Account Information</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Do you want to send a request to this account?
                </div>
                <div class="modal-footer">
                    <button data-id="id" id="sent" type="button" class="btn btn-primary">Send</button>
                    <button type="button" class="btn btn-sencondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>


    <!-- Unlock Modal -->
    <div class="modal fade" id="unlock-confirm" tabindex="-1" role="dialog" aria-labelledby="unlockLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">Unlock Account</h4>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    Do you want to unlock <strong id="account">test</strong> account?
                </div>
                <div class="modal-footer">
                    <button data-id="id" data-lock="date" id="unlocked" type="button"
                        class="btn btn-primary">Yes</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    function goBack() {
        window.history.back();
    }
    //active account
    $('.btn-approve').click(e => {
        const btn = e.target
        const userid = btn.dataset.id
        console.log(userid)
        $('#approved').attr('data-id', userid)
        $('#approve-confirm').modal('show')
    })

    $('#approve-confirm').click(e => {
        $('#approve-confirm').modal('hide')
        const btn = e.target
        const userid = btn.dataset.id
        console.log(userid)
        $.ajax({
            url: '/admin/approve',
            method: 'post',
            data: { userid: userid },
            success: function (data) {
                alert('Account is Actived')
                window.location.reload()
            },
        })
    })

    //decline account
    $('.btn-decline').click(e => {
        const btn = e.target
        const userid = btn.dataset.id
        console.log(userid)
        $('#declined').attr('data-id', userid)
        $('#decline-confirm').modal('show')
    })

    $('#decline-confirm').click(e => {
        $('#decline-confirm').modal('hide')
        const btn = e.target
        const userid = btn.dataset.id
        console.log(userid)
        $.ajax({
            url: '/admin/decline',
            method: 'post',
            data: { userid: userid },
            success: function (data) {
                alert('Account is Disabled')
                window.location.reload()
            },
        })
    })

    //send request to account
    $('.btn-send').click(e => {
        const btn = e.target
        const userid = btn.dataset.id
        console.log(userid)
        $('#sent').attr('data-id', userid)
        $('#send-confirm').modal('show')
    })

    $('#send-confirm').click(e => {
        $('#send-confirm').modal('hide')
        const btn = e.target
        const userid = btn.dataset.id
        console.log(userid)
        $.ajax({
            url: '/admin/request',
            method: 'post',
            data: { userid: userid },
            success: function (data) {
                alert('Account required additional information')
                window.location.reload()
            },
        })
    })

    //unlock account
    $('.btn-unlock').click(e => {
        const btn = e.target
        const userid = btn.dataset.id
        const userName = btn.dataset.name
        const lockedDate = btn.dataset.lock

        console.log(userid)
        console.log(userName)
        console.log(lockedDate)

        $('#account').html(userName)

        $('#unlocked').attr('data-id', userid)
        $('#unlocked').attr('data-lock', lockedDate)

        $('#unlock-confirm').modal('show')
    })

    $('#unlock-confirm').click(e => {
        $('#unlock-confirm').modal('hide')
        const btn = e.target
        const userid = btn.dataset.id
        const lockedDate = btn.dataset.lock

        console.log(lockedDate)
        console.log(userid)
        $.ajax({
            url: '/admin/unlock',
            method: 'post',
            data: { userid: userid, lockedDate: lockedDate },
            success: function (data) {
                alert('Account is Unlocked')
                window.location.reload()
            },
        })
    })

</script>